(function(t){"use strict";function e(t,e,i){n.push({name:t,drawShape:e,drawBorder:i})}function i(r){return function(t,e,i,a,l,n){n.fillStyle=l,n.beginPath(),r(t,e,i,a,n),n.closePath(),n.fill()}}function a(r){return function(t,e,i,a,l,n){n.strokeStyle=l,n.lineWidth=a/5,n.beginPath(),r(t,e,i,a,n),n.closePath(),n.stroke()}}function l(t,e,i,a,l){var n=45*Math.PI/180;l.moveTo(e+a*Math.sin(n),i-a*Math.cos(n));for(var r=1;r<4;r++)l.lineTo(e+Math.sin(n+2*Math.PI*r/4)*a,i-Math.cos(n+2*Math.PI*r/4)*a)}var n=[];e("square",i(l),a(l));function r(t,e,i,a,l){l.arc(e,i,a,0,2*Math.PI,!0)}e("circle",i(r),a(r));function o(t,e,i,a,l){l.moveTo(e-a,i),l.lineTo(e,i-a),l.lineTo(e+a,i),l.lineTo(e,i+a)}e("diamond",i(o),a(o));function s(t,e,i,a,l){var n=t.cross&&t.cross.lineWeight||5;l.moveTo(e-a,i-n),l.lineTo(e-a,i+n),l.lineTo(e-n,i+n),l.lineTo(e-n,i+a),l.lineTo(e+n,i+a),l.lineTo(e+n,i+n),l.lineTo(e+a,i+n),l.lineTo(e+a,i-n),l.lineTo(e+n,i-n),l.lineTo(e+n,i-a),l.lineTo(e-n,i-a),l.lineTo(e-n,i-n)}e("cross",i(s),a(s));function c(t,e,i,a,l){var n=t.equilateral&&t.equilateral.numPoints||5,r=(t.equilateral&&t.equilateral.rotate||0)*Math.PI/180,o=a;l.moveTo(e+o*Math.sin(r),i-o*Math.cos(r));for(var s=1;s<n;s++)l.lineTo(e+Math.sin(r+2*Math.PI*s/n)*o,i-Math.cos(r+2*Math.PI*s/n)*o)}e("equilateral",i(c),a(c));function u(t,e,i,a,l){var n=t.star&&t.star.numPoints||5,r=a,o=a*(t.star&&t.star.innerRatio||.5),s=Math.PI/n;l.moveTo(e,i-a);for(var c=0;c<n;c++)l.lineTo(e+Math.sin(s+2*Math.PI*c/n)*o,i-Math.cos(s+2*Math.PI*c/n)*o),l.lineTo(e+Math.sin(2*Math.PI*(c+1)/n)*r,i-Math.cos(2*Math.PI*(c+1)/n)*r)}e("star",i(u),a(u));e("pacman",function(t,e,i,a,l,n){n.fillStyle="yellow",n.beginPath(),n.arc(e,i,a,1.25*Math.PI,0,!1),n.arc(e,i,a,0,.75*Math.PI,!1),n.lineTo(e,i),n.closePath(),n.fill(),n.fillStyle="white",n.strokeStyle="black",n.beginPath(),n.arc(e+a/3,i-a/3,a/4,0,2*Math.PI,!1),n.closePath(),n.fill(),n.stroke(),n.fillStyle="black",n.beginPath(),n.arc(e+4*a/9,i-a/3,a/8,0,2*Math.PI,!1),n.closePath(),n.fill()},null),this.ShapeLibrary={enumerate:function(){return n},version:"0.1"}}).call(this),function(t){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";if("undefined"==typeof ShapeLibrary)throw"ShapeLibrary is not declared";sigma.utils.pkg("sigma.canvas.nodes"),sigma.utils.pkg("sigma.svg.nodes");function e(t,A,T){sigma.canvas.nodes[t]=function(t,e,i){var a,l,n,r,o,s,c,u,h,d,f,m,g,S,p=i("prefix")||"",M=t[p+"size"],b=t.color||i("defaultNodeColor"),P=t.borderColor||b,N=t[p+"x"],v=t[p+"y"];e.save(),A&&A(t,N,v,M,b,e),T&&T(t,N,v,M,P,e),a=t,l=N,n=v,r=M,o=e,y&&a.image&&a.image.url&&(s=a.image.url,c=a.image.h||1,u=a.image.w||1,h=a.image.scale||1,d=a.image.clip||1,(f=I[s])||((f=document.createElement("IMG")).src=s,f.status="loading",f.onerror=function(){console.log("error loading",s),f.status="error"},f.onload=function(){console.log("redraw on image load",s),f.status="ok",y.refresh()},I[s]=f),m=u<c?u/c:1,g=c<u?c/u:1,S=r*h,o.save(),o.beginPath(),o.arc(l,n,r*d,0,2*Math.PI,!0),o.closePath(),o.clip(),"ok"===f.status&&o.drawImage(f,l+Math.sin(-.7855)*S*m,n-Math.cos(-.7855)*S*g,S*m*2*Math.sin(-.7855)*-1,S*g*2*Math.cos(-.7855)),o.restore()),e.restore()},sigma.svg.nodes[t]={create:function(t,e){var i,a,l,n,r,o,s,c,u,h=document.createElementNS(e("xmlns"),"g"),d=document.createElementNS(e("xmlns"),"circle");return h.setAttributeNS(null,"class",e("classPrefix")+"-node-group"),h.setAttributeNS(null,"data-node-id",t.id),d.setAttributeNS(null,"data-node-id",t.id),d.setAttributeNS(null,"class",e("classPrefix")+"-node"),d.setAttributeNS(null,"fill",t.color||e("defaultNodeColor")),h.appendChild(d),i=t,a=h,l=e,y&&i.image&&i.image.url&&(n=document.createElementNS(l("xmlns"),"circle"),r=document.createElementNS(l("xmlns"),"clipPath"),o=l("classPrefix")+"-clip-path-"+i.id,s=document.createElementNS(l("xmlns"),"defs"),c=document.createElementNS(l("xmlns"),"image"),i.image.url,r.setAttributeNS(null,"id",o),r.appendChild(n),s.appendChild(r),u=(u=/MSIE [5-9]/.test(navigator.userAgent)?"":document.location.href).split("#")[0],c.setAttributeNS(null,"class",l("classPrefix")+"-node-image"),c.setAttributeNS(null,"clip-path","url("+u+"#"+o+")"),c.setAttributeNS(null,"pointer-events","none"),c.setAttributeNS("http://www.w3.org/1999/xlink","href",i.image.url),a.appendChild(s),a.appendChild(c)),h},update:function(t,e,i){for(var a=i("classPrefix"),l=t.image.clip||1,n=t.image.h||1,r=t.image.w||1,o=i("prefix")||"",s=t.image.scale||1,c=t[o+"size"],u=t[o+"x"],h=t[o+"y"],d=s*c,f=r<n?r/n:1,m=n<r?n/r:1,g=0,S=e.childNodes;g<S.length;g++){switch(S[g].getAttribute("class")){case a+"-node":S[g].setAttributeNS(null,"cx",u),S[g].setAttributeNS(null,"cy",h),S[g].setAttributeNS(null,"r",c),i("freeStyle")||S[g].setAttributeNS(null,"fill",t.color||i("defaultNodeColor"));break;case a+"-node-image":S[g].setAttributeNS(null,"x",u+Math.sin(-.7855)*d*f),S[g].setAttributeNS(null,"y",h-Math.cos(-.7855)*d*m),S[g].setAttributeNS(null,"width",d*f*2*Math.sin(-.7855)*-1),S[g].setAttributeNS(null,"height",d*m*2*Math.cos(-.7855));break;default:var p,M=S[g].firstChild;null!=M&&(p=a+"-clip-path-"+t.id,M.getAttribute("id")===p&&(M.firstChild.setAttributeNS(null,"cx",u),M.firstChild.setAttributeNS(null,"cy",h),M.firstChild.setAttributeNS(null,"r",l*c)))}}e.style.display=""}}}var y=t,I={};ShapeLibrary.enumerate().forEach(function(t){e(t.name,t.drawShape,t.drawBorder)}),this.CustomShapes={init:function(t){y=t},version:"0.1"}}.call(this);